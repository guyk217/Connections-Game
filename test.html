<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>בדיקת חיבור ל־levels.json</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body { font-family: system-ui, sans-serif; padding: 20px; background: #f2f2f2; text-align: right; direction: rtl; }
    h1 { font-size: 24px; margin-bottom: 20px; }
    textarea { width: 100%; height: 300px; font-family: monospace; font-size: 14px; direction: ltr; }
    input, button { padding: 10px; font-size: 16px; width: 100%; margin-bottom: 10px; }
    .btn { background: #333; color: white; border: none; border-radius: 5px; cursor: pointer; }
  </style>
</head>
<body>
  <h1>🔍 בדיקת גישה ל־levels.json</h1>
  <input type="password" id="token" placeholder="הכנס טוקן GitHub כאן" />
  <button class="btn" onclick="runTest()">התחל בדיקה</button>
  <textarea id="output" readonly></textarea>

  <script>
    async function runTest() {
      const token = document.getElementById("token").value.trim();
      const log = (msg) => {
        const out = document.getElementById("output");
        out.value += msg + "\n";
        out.scrollTop = out.scrollHeight;
      };

      document.getElementById("output").value = "";
      if (!token) return log("❌ לא הוזן טוקן");

      log("🚀 מתחיל בדיקה...");
      log("📥 מבצע GET ל־levels.json...");

      const url = "https://api.github.com/repos/guyk217/Connections-Game/contents/levels.json";

      try {
        const res = await fetch(url, {
          headers: {
            Authorization: `token ${token}`,
            Accept: "application/vnd.github.v3+json"
          }
        });

        if (!res.ok) {
          log(`❌ שגיאה: ${res.status} ${res.statusText}`);
          const err = await res.json();
          if (err.message) log("🧾 הודעת שגיאה: " + err.message);
          return;
        }

        const json = await res.json();
        log("✅ קובץ אותר בהצלחה!");
        log("🔢 SHA: " + json.sha);
        log("📦 תוכן (base64):");
        log(json.content.substring(0, 200) + "...");
      } catch (e) {
        log("💥 שגיאת JavaScript כללית:");
        log(e.message || e.toString());
      }
    }
  </script>
</body>
</html>