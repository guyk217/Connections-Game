<!DOCTYPE html>
<html dir="rtl" lang="he">
<head>
  <meta charset="UTF-8" />
  <title>×‘×“×™×§×ª ×›×ª×™×‘×” ×œÖ¾GitHub</title>
  <style>
    body { font-family: sans-serif; background: #fffbe7; text-align: center; padding: 30px; }
    button { font-size: 18px; padding: 10px 20px; margin-top: 20px; }
    pre { text-align: left; direction: ltr; background: #eee; padding: 10px; overflow-x: auto; }
  </style>
</head>
<body>
  <h2>ğŸ” ×‘×“×™×§×ª ×›×ª×™×‘×” ×œ×§×•×‘×¥ levels.json</h2>
  <button onclick="startTest()">×”×¤×¢×œ ×‘×“×™×§×”</button>
  <pre id="log">××•×›×Ÿ...</pre>

  <script>
    const token = "ghp_..."; // â† ×”×“×‘×§ ×›××Ÿ ××ª ×”×˜×•×§×Ÿ ×©×œ×š
    const repo = "guyk217/Connections-Game";
    const path = "levels.json";

    const api = `https://api.github.com/repos/${repo}/contents/${path}`;
    const headers = {
      Authorization: `Bearer ${token}`,
      Accept: "application/vnd.github.v3+json"
    };

    async function startTest() {
      log("ğŸš€ ×˜×•×¢×Ÿ ××ª ×”×§×•×‘×¥...");
      const res = await fetch(api, { headers });
      if (!res.ok) return log("âŒ ×©×’×™××” ×‘×˜×¢×™× ×”: " + res.status);

      const data = await res.json();
      const sha = data.sha;
      const originalText = atob(data.content.replace(/\n/g, ""));
      navigator.clipboard.writeText(originalText);
      log("ğŸ“‹ ×”×ª×•×›×Ÿ ×”××§×•×¨×™ ×”×•×¢×ª×§ ×œÖ¾Clipboard");

      let json;
      try {
        json = JSON.parse(originalText);
        if (!Array.isArray(json)) throw "×§×•×‘×¥ ×œ× ×‘××‘× ×” ×©×œ ××¢×¨×š";
      } catch (e) {
        return log("âŒ ×©×’×™××ª JSON: " + e);
      }

      const testLevel = {
        title: "×©×œ×‘ ×‘×“×™×§×”",
        words: [
          "×‘×“×™×§×”1", "×‘×“×™×§×”2", "×‘×“×™×§×”3", "×‘×“×™×§×”4",
          "×‘×“×™×§×”5", "×‘×“×™×§×”6", "×‘×“×™×§×”7", "×‘×“×™×§×”8",
          "×‘×“×™×§×”9", "×‘×“×™×§×”10", "×‘×“×™×§×”11", "×‘×“×™×§×”12",
          "×‘×“×™×§×”13", "×‘×“×™×§×”14", "×‘×“×™×§×”15", "×‘×“×™×§×”16"
        ],
        groups: {
          "×§×‘×•×¦×” ×": ["×‘×“×™×§×”1", "×‘×“×™×§×”2", "×‘×“×™×§×”3", "×‘×“×™×§×”4"],
          "×§×‘×•×¦×” ×‘": ["×‘×“×™×§×”5", "×‘×“×™×§×”6", "×‘×“×™×§×”7", "×‘×“×™×§×”8"],
          "×§×‘×•×¦×” ×’": ["×‘×“×™×§×”9", "×‘×“×™×§×”10", "×‘×“×™×§×”11", "×‘×“×™×§×”12"],
          "×§×‘×•×¦×” ×“": ["×‘×“×™×§×”13", "×‘×“×™×§×”14", "×‘×“×™×§×”15", "×‘×“×™×§×”16"]
        },
        hintPair: ["×‘×“×™×§×”1", "×‘×“×™×§×”2"]
      };

      json.push(testLevel);
      const newContent = btoa(unescape(encodeURIComponent(JSON.stringify(json, null, 2))));

      log("ğŸ“ ×©×•××¨ ×¢× ×©×œ×‘ ×‘×“×™×§×”...");
      const updateRes = await fetch(api, {
        method: "PUT",
        headers,
        body: JSON.stringify({
          message: "×‘×“×™×§×ª ×›×ª×™×‘×” ×œ×§×•×‘×¥ levels.json",
          content: newContent,
          sha
        })
      });

      if (updateRes.ok) {
        log("âœ… ×”×§×•×‘×¥ ×¢×•×“×›×Ÿ ×‘×”×¦×œ×—×”!");
      } else {
        const err = await updateRes.json();
        log("âŒ ×©×’×™××” ×‘×©××™×¨×”: " + JSON.stringify(err, null, 2));
      }
    }

    function log(msg) {
      document.getElementById("log").textContent = msg;
    }
  </script>
</body>
</html>